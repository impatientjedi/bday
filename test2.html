<style>
  :root{
    /* Subtle, colorful palette */
    --bg1:#f6f7ff;
    --bg2:#f2fbff;
    --card:#ffffff;
    --border:#e6e8f5;
    --text:#111827;
    --muted:#6b7280;

    /* Accent */
    --accent:#6d5efc;      /* violet */
    --accent2:#22c3ee;     /* cyan */
    --accent3:#34d399;     /* green */

    /* Shadows */
    --shadow: 0 10px 30px rgba(17,24,39,0.08);
    --shadow2: 0 6px 18px rgba(17,24,39,0.06);

    --radius:16px;
  }

  html, body{
  margin:0;
  padding:0;
  color:var(--text);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;

  background:
    /* bright confetti dots (primary) */
    radial-gradient(circle at 18px 22px, rgba(109,94,252,0.28) 2.6px, transparent 3.2px) 0 0/120px 120px,
    radial-gradient(circle at 86px 62px, rgba(34,195,238,0.28) 2.6px, transparent 3.2px) 0 0/140px 140px,
    radial-gradient(circle at 52px 104px, rgba(52,211,153,0.26) 2.6px, transparent 3.2px) 0 0/160px 160px,
    radial-gradient(circle at 112px 36px, rgba(245,158,11,0.24) 2.6px, transparent 3.2px) 0 0/180px 180px,
    radial-gradient(circle at 34px 142px, rgba(236,72,153,0.22) 2.6px, transparent 3.2px) 0 0/200px 200px,

    /* secondary smaller dots for density */
    radial-gradient(circle at 24px 92px, rgba(109,94,252,0.16) 1.8px, transparent 2.4px) 0 0/210px 210px,
    radial-gradient(circle at 156px 148px, rgba(34,195,238,0.16) 1.8px, transparent 2.4px) 0 0/230px 230px,
    radial-gradient(circle at 190px 54px, rgba(52,211,153,0.15) 1.8px, transparent 2.4px) 0 0/250px 250px,
    radial-gradient(circle at 88px 188px, rgba(245,158,11,0.14) 1.8px, transparent 2.4px) 0 0/270px 270px,

    /* soft “spotlight” washes behind the confetti */
    radial-gradient(900px 520px at 18% -10%, rgba(109,94,252,0.22), rgba(0,0,0,0) 62%),
    radial-gradient(900px 520px at 92% 8%, rgba(34,195,238,0.22), rgba(0,0,0,0) 62%),
    radial-gradient(800px 520px at 55% 115%, rgba(52,211,153,0.12), rgba(0,0,0,0) 60%),

    /* base gradient */
    linear-gradient(180deg, var(--bg1), var(--bg2));
}


  /* Main wrapper */
  #bc-wrap{
    width:min(920px, 92%);
    margin:42px auto 70px auto;
  }

  /* Notes (warning / info) */
  #bc-note{
    display:none;
    border-radius: 14px;
    padding: 12px 14px;
    margin-bottom: 14px;
    border: 1px solid rgba(245,158,11,0.35);
    background: linear-gradient(180deg, rgba(255,247,237,0.95), rgba(255,251,235,0.95));
    box-shadow: var(--shadow2);
  }

  /* Card base */
  .bc-card{
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 18px;
    box-shadow: var(--shadow);
    position: relative;
    overflow: hidden;
  }

  /* Subtle colorful top edge */
  .bc-card::before{
    content:"";
    position:absolute;
    top:0; left:0; right:0;
    height: 3px;
    background: linear-gradient(90deg, var(--accent), var(--accent2), var(--accent3));
    opacity: 0.9;
  }

  /* Header row */
  .bc-header{
    display:flex;
    gap:14px;
    align-items:center;
  }

  #bc-logo{
    display:none;
    max-height:54px;
    max-width:220px;
    border-radius: 10px;
    box-shadow: 0 6px 16px rgba(17,24,39,0.10);
    background:#fff;
  }

  #bc-business{
    margin:0;
    font-size: 26px;
    line-height: 1.15;
    letter-spacing: -0.02em;
  }

  /* Offer title + description */
  #bc-title{
    margin: 14px 0 6px 0;
    font-size: 20px;
    line-height: 1.2;
    letter-spacing: -0.01em;
  }

  #bc-desc{
    margin:0;
    color: rgba(17,24,39,0.88);
    white-space: pre-wrap;
    font-size: 15.5px;
    line-height: 1.55;
  }

  /* Offer image */
  #bc-image{
    display:none;
    width:100%;
    max-height: 340px;
    object-fit: cover;
    border-radius: 14px;
    margin-top: 14px;
    border: 1px solid var(--border);
    box-shadow: 0 10px 24px rgba(17,24,39,0.10);
  }

  /* Fine print */
  #bc-fine{
    font-size: 12.5px;
    line-height: 1.45;
    color: var(--muted);
    margin-top: 12px;
    white-space: pre-wrap;
  }

  /* Form card spacing */
  #bc-form-card{
    margin-top: 18px;
  }

  #bc-form-card h3{
    margin: 2px 0 12px 0;
    font-size: 16px;
    color: rgba(17,24,39,0.92);
    letter-spacing: -0.01em;
  }

  /* Loading skeleton */
  #bc-form-loading{
    border-radius: 14px;
    padding: 14px;
    border: 1px solid rgba(109,94,252,0.16);
    background:
      linear-gradient(180deg, rgba(246,247,255,0.75), rgba(242,251,255,0.65));
  }

  .sk-line{
    height: 14px;
    border-radius: 999px;
    background: linear-gradient(90deg,
      rgba(109,94,252,0.18) 20%,
      rgba(34,195,238,0.18) 40%,
      rgba(109,94,252,0.18) 60%);
    background-size: 300% 100%;
    animation: shimmer 1.15s infinite;
    margin: 10px 0;
    filter: saturate(1.05);
  }

  .sk-line.w60{ width:60%; }
  .sk-line.w80{ width:80%; }
  .sk-line.w95{ width:95%; }

  @keyframes shimmer{
    0%{ background-position: 0% 0; }
    100%{ background-position: 100% 0; }
  }

  /* Fade in form */
  #jf-wrap{
    opacity: 0;
    transform: translateY(6px);
    transition: opacity 240ms ease, transform 240ms ease;
  }
  #jf-wrap.ready{
    opacity: 1;
    transform: translateY(0);
  }

  /* Optional: make the embedded form feel centered */
  #jf-wrap iframe{
    border-radius: 14px;
  }

  /* Responsive tweaks */
  @media (max-width: 560px){
    #bc-business{ font-size: 22px; }
    #bc-title{ font-size: 18px; }
    .bc-card{ padding: 16px; }
  }
</style>


<div id="bc-wrap">
  <div id="bc-note"></div>

  <!-- Offer / Business info -->
  <div class="bc-card">
    <div class="bc-header">
      <img id="bc-logo" alt="Business logo" />
      <h1 id="bc-business">Loading…</h1>
    </div>

    <h2 id="bc-title" style="margin:12px 0 6px 0;"></h2>
    <p id="bc-desc" style="margin:0;white-space:pre-wrap;"></p>

    <img id="bc-image" alt="Offer image" />

    <div id="bc-fine"></div>
  </div>

  <!-- Form (same design language) -->
  <div id="bc-form-card" class="bc-card">
    <h3 style="margin:0 0 10px 0;">Sign up</h3>

    <div id="bc-form-loading">
      <div class="sk-line w60"></div>
      <div class="sk-line w95"></div>
      <div class="sk-line w80"></div>
      <div class="sk-line w95"></div>
      <div class="sk-line w80"></div>
    </div>

    <div id="jf-wrap"></div>
  </div>
</div>

<script>
  // ========= EDIT THESE =========
  const PD_GET_BUSINESS_URL = "https://eompxe9l4vf4e3z.m.pipedream.net/get-business"; // must return JSON
  const JOTFORM_FORM_ID = "260478526701055";
  const JOTFORM_BUSINESS_ID_FIELD = "bid";     // your hidden field unique name
  const JOTFORM_SOURCE_FIELD = "source";       // your hidden field unique name
  // ==============================

  function qs(name) {
    return new URLSearchParams(window.location.search).get(name);
  }
  function showNote(msg) {
    const el = document.getElementById("bc-note");
    el.style.display = "block";
    el.textContent = msg;
  }
  function setText(id, text) {
    const el = document.getElementById(id);
    if (el) el.textContent = text || "";
  }
  function setImg(id, url) {
    const el = document.getElementById(id);
    if (!el) return;
    if (url) {
      el.src = url;
      el.style.display = "block";
    } else {
      el.style.display = "none";
    }
  }

  async function loadBusiness(businessId) {
    const res = await fetch(PD_GET_BUSINESS_URL + "?b=" + encodeURIComponent(businessId), { cache: "no-store" });

    if (!res.ok) {
      const t = await res.text().catch(() => "");
      throw new Error("Business lookup failed (HTTP " + res.status + "). " + (t ? ("Body: " + t.slice(0,120)) : ""));
    }

    const txt = await res.text();
    let cfg;
    try { cfg = JSON.parse(txt); }
    catch { throw new Error("Endpoint did not return JSON. First 80 chars: " + txt.slice(0,80)); }

    return cfg;
  }

  function embedJotform(businessId) {
    const source = window.location.href;

    const s = document.createElement("script");
    s.type = "text/javascript";

    const src = new URL("https://form.jotform.com/jsform/" + JOTFORM_FORM_ID);
    if (businessId) src.searchParams.set(JOTFORM_BUSINESS_ID_FIELD, businessId);
    src.searchParams.set(JOTFORM_SOURCE_FIELD, source);

    s.src = src.toString();

    const wrap = document.getElementById("jf-wrap");
    wrap.appendChild(s);

    // jsform loads async; we fade in after a short delay + also on load event
    setTimeout(() => {
      document.getElementById("bc-form-loading").style.display = "none";
      wrap.classList.add("ready");
    }, 800);

    s.addEventListener("load", () => {
      document.getElementById("bc-form-loading").style.display = "none";
      wrap.classList.add("ready");
    });
  }

  (async function init() {
    const businessId = qs("b") || "";

    if (!businessId) {
      setText("bc-business", "Missing business ID");
      showNote("Use: /signup?b=YOUR_BUSINESS_ID");
      embedJotform("");
      return;
    }

    embedJotform(businessId);

    try {
      const cfg = await loadBusiness(businessId);

      if (cfg.status && cfg.status !== "active") {
        showNote("This birthday club is currently unavailable.");
      }

      setText("bc-business", (cfg.business_name || "Birthday Club") + " Birthday Club");
      setImg("bc-logo", cfg.logo_url);

      setText("bc-title", cfg.offer_title || "");
      setText("bc-desc", cfg.offer_description || "");
      setImg("bc-image", cfg.offer_image_url);

      setText("bc-fine", cfg.fine_print || "");
    } catch (e) {
      console.error(e);
      setText("bc-business", "Birthday Club");
      showNote(e.message || "We couldn't load this business's offer. Please try again later.");
    }
  })();
</script>
